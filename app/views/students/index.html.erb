<h1>Students for <%= @section.uniqueSectionCode %> </h1>

<table>
  <tr>
    <th>Name</th>
    <th>Average Grade</th>
    <th>Performance</th>
    <th>Performance</th>
    <th></th>
  </tr>

  <% @students.each do |student| %>
      <tr class=".student-row">
        <td><%= full_name(student) %></td>
        <td><%= student.average_grade %></td>
        <td width="100%">
          <div class="progressBar" data-progress="<%= student.average_grade %>"></div>
        </td>
        <td class="average_score" width="100%">
          <span class="sparklines average_score1" data-grade="<%= student.average_grade %>" data-values="<%= "80,#{student.average_grade},100,85,60" %>"></span>
        </td>
        <td width="100%">
          <span class="sparklines average_score2" performanceColor="<%= grade_color(student.average_grade) %>" data-values="<%= "80,#{student.average_grade},100,85,60" %>"></span>
        </td>
        <td width="100%">
          <span class="sparklines grades" data-values="<%= student.grades.join(',') %>"></span>
        </td>
        <td width="100%" class="hide alert-button">
          <a href="#" class="btn">Alert Parents</a>
        </td>
      </tr>
  <% end %>
</table>

<br />
<%=  debug @students %>

<script type="text/javascript">
  jQuery(function(){

    $(".progressBar").each(function(){
      var progVal = $(this).data("progress");
      $(this).progressbar({
        value: progVal
      });
      if (progVal > 80){
        $(this).find(".ui-progressbar-value").addClass("highGrade");
      } else if ((progVal > 65) && (progVal <= 80) ){
        $(this).find(".ui-progressbar-value").addClass("averageGrade");
      } else if (progVal <= 65){
        $(this).find(".ui-progressbar-value").addClass("lowGrade");
        $(this).parent().parent().find(".alert-button").removeClass("hide");
      }

    });

  });
</script>
